[package]
name = "machi"
version.workspace = true
edition.workspace = true
description = "A Web3-native AI Agent Framework with embedded wallet capabilities"
license.workspace = true
readme = "../README.md"
repository.workspace = true
keywords = ["agent", "ai", "web3", "wallet", "llm"]
categories = ["cryptography", "asynchronous"]

[package.metadata.docs.rs]
all-features = true
rustdoc-args = ["--cfg", "docsrs"]

[lib]
name = "machi"
path = "src/lib.rs"
doctest = false

[dependencies]
as-any.workspace = true
async-stream.workspace = true
base64.workspace = true
bytes.workspace = true
eventsource-stream.workspace = true
fastrand.workspace = true
futures.workspace = true
futures-timer.workspace = true
glob.workspace = true
http.workspace = true
mime.workspace = true
mime_guess.workspace = true
ordered-float.workspace = true
pin-project-lite.workspace = true
reqwest.workspace = true
schemars.workspace = true
serde.workspace = true
serde_json.workspace = true
thiserror.workspace = true
tokio.workspace = true
tracing.workspace = true
tracing-futures.workspace = true
url.workspace = true

# Optional dependencies
epub = { workspace = true, optional = true }
lopdf = { workspace = true, optional = true }
machi-derive = { workspace = true, optional = true }
quick-xml = { workspace = true, optional = true }
rayon = { workspace = true, optional = true }
reqwest-middleware = { workspace = true, optional = true }
rmcp = { workspace = true, optional = true }
wasm-bindgen-futures = { workspace = true, optional = true }

[dev-dependencies]
anyhow.workspace = true
assert_fs.workspace = true
hyper-util.workspace = true
serde_path_to_error.workspace = true
tokio = { workspace = true, features = ["full"] }
tokio-test.workspace = true
tracing-subscriber.workspace = true

[features]
default = ["reqwest-tls"]
all = ["derive", "pdf", "rayon"]
audio = []
image = []
derive = ["dep:machi-derive"]
experimental = []
pdf = ["dep:lopdf"]
epub = ["dep:epub", "dep:quick-xml"]
rayon = ["dep:rayon"]
wasm = ["dep:wasm-bindgen-futures", "futures-timer/wasm-bindgen"]
rmcp = ["dep:rmcp"]
socks = ["reqwest/socks"]
reqwest-tls = ["reqwest/default"]
reqwest-rustls = ["reqwest/rustls", "reqwest/charset", "reqwest/http2"]
reqwest-middleware = ["dep:reqwest-middleware"]
reqwest-middleware-rustls = ["reqwest-middleware", "reqwest-rustls"]

[[example]]
name = "agent_with_mcp_tools"
required-features = ["rmcp"]

[[example]]
name = "mcp_server"
required-features = ["rmcp"]

[[example]]
name = "tools_macro"
required-features = ["derive"]

[[example]]
name = "agent_with_tools_macro"
required-features = ["derive"]

[[example]]
name = "agent_with_rag"
required-features = ["derive"]

[lints]
workspace = true
